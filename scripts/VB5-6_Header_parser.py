import sys
import codecs

def get_bytes(raw, start, end):
    bytes_array = ""
    for x in range(int(start), int(end) + 1):
        bytes_array += raw[x] + " "
    return(bytes_array)

header_file = sys.argv[1]

with open (header_file, "r") as header:
    for content in header:
        raw = content.split(" ")
        print("== VB5/6 header ==")
        
        Signature = get_bytes(raw, 0, 3)#raw[0] +" "+ raw[1] +" "+ raw[2] +" "+ raw[3]
        if str(Signature) != "56 42 35 21 ":
            if str(Signature) != "56 42 36 21 ":
                print("[-] Not a valid VB5/VB6 header.")
                exit(-1)
        print("Signature: " + Signature + " [" + str(codecs.decode(str(Signature).replace(" ",""), "hex"))[:-1][2:] + "]")
        
        RuntimeBuild = get_bytes(raw, 4, 5)
        print("RuntimeBuild: " + RuntimeBuild)

        LanguageDLL = get_bytes(raw, 6, 5+14)
        print("LanguageDLL: " + LanguageDLL)

        BackupLanguageDLL = get_bytes(raw, 6+14, 5+14*2)
        print("BackupLanguageDLL: " + BackupLanguageDLL)

        RuntimeDLLVersion = get_bytes(raw, 5+14*2+1, 5+14*2+2)
        print("RuntimeDLLVersion: " + RuntimeDLLVersion)

        LanguageID = get_bytes(raw, 36, 36+3)
        print("LanguageID: " + LanguageID)

        BackupLanguageID = get_bytes(raw, 40, 43)
        print("BackupLanguageID: " + BackupLanguageID)

        aSubMain = get_bytes(raw, 44, 47)
        if str(aSubMain).replace(" ","") == "00000000":
            print("aSubMain: " + aSubMain + "(Good luck for the unpack!)")
        else:
            print("aSubMain: " + aSubMain + "(Here is the EntryPoint)")

        aProjectInfo = get_bytes(raw, 48, 51)
        print("aProjectInfo: " + aProjectInfo)

        fMDLIntObjs = get_bytes(raw, 52, 55)
        print("fMDLIntObjs: " + fMDLIntObjs)

        fMDLIntObjs2 = get_bytes(raw, 56, 55+4)
        print("fMDLIntObjs2: " + fMDLIntObjs2)

        ThreadFlags = get_bytes(raw, 60, 63)
        print("ThreadFlags: " + ThreadFlags)

        ThreadCount = get_bytes(raw, 64, 67)
        print("ThreadCount: " + ThreadCount)

        aGUITable = get_bytes(raw, 68, 71)
        print("aGUITable: " + aGUITable)

        aExternalComponentTable = get_bytes(raw, 72, 75)
        print("aExternalComponentTable: " + aExternalComponentTable)

        aComRegisterData = get_bytes(raw, 76, 79)
        print("aComRegisterData: " + aComRegisterData)

        oProjectExename = get_bytes(raw, 80, 83)
        print("oProjectExename: " + oProjectExename)

        oProjectTitle = get_bytes(raw, 84, 87)
        print("oProjectTitle: " + oProjectTitle)

        oHelpFile = get_bytes(raw, 88, 91)
        print("oHelpFile: " + oHelpFile)

        oProjectName = get_bytes(raw, 92, 95)
        print("oProjectName: " + oProjectName)
